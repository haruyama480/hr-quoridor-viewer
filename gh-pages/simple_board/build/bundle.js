var app=function(){"use strict";function t(){}const n=t=>t;function e(t,n){for(const e in n)t[e]=n[e];return t}function r(t){return t()}function i(){return Object.create(null)}function l(t){t.forEach(r)}function o(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}const s="undefined"!=typeof window;let c=s?()=>window.performance.now():()=>Date.now(),u=s?t=>requestAnimationFrame(t):t;const d=new Set;function h(t){d.forEach((n=>{n.c(t)||(d.delete(n),n.f())})),0!==d.size&&u(h)}function p(t){let n;return 0===d.size&&u(h),{promise:new Promise((e=>{d.add(n={c:t,f:e})})),abort(){d.delete(n)}}}function f(t,n){t.appendChild(n)}function _(t){if(!t)return document;const n=t.getRootNode?t.getRootNode():t.ownerDocument;return n&&n.host?n:t.ownerDocument}function y(t){const n=$("style");return function(t,n){f(t.head||t,n)}(_(t),n),n}function g(t,n,e){t.insertBefore(n,e||null)}function w(t){t.parentNode.removeChild(t)}function m(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function $(t){return document.createElement(t)}function b(t){return document.createTextNode(t)}function v(){return b("")}function k(t,n,e,r){return t.addEventListener(n,e,r),()=>t.removeEventListener(n,e,r)}function z(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function x(t,n,e,r){t.style.setProperty(n,e,r?"important":"")}function P(t,n,e){t.classList[e?"add":"remove"](n)}function C(t,n,e=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e,!1,n),r}const O=new Set;let A,M=0;function S(t,n,e,r,i,l,o,a=0){const s=16.666/r;let c="{\n";for(let t=0;t<=1;t+=s){const r=n+(e-n)*l(t);c+=100*t+`%{${o(r,1-r)}}\n`}const u=c+`100% {${o(e,1-e)}}\n}`,d=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(u)}_${a}`,h=_(t);O.add(h);const p=h.__svelte_stylesheet||(h.__svelte_stylesheet=y(t).sheet),f=h.__svelte_rules||(h.__svelte_rules={});f[d]||(f[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${d} ${r}ms linear ${i}ms 1 both`,M+=1,d}function W(t,n){const e=(t.style.animation||"").split(", "),r=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),i=e.length-r.length;i&&(t.style.animation=r.join(", "),M-=i,M||u((()=>{M||(O.forEach((t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}})),O.clear())})))}function E(t){A=t}function N(){const t=function(){if(!A)throw new Error("Function called outside component initialization");return A}();return(n,e)=>{const r=t.$$.callbacks[n];if(r){const i=C(n,e);r.slice().forEach((n=>{n.call(t,i)}))}}}const H=[],J=[],V=[],T=[],j=Promise.resolve();let I=!1;function R(t){V.push(t)}let G=!1;const q=new Set;function B(){if(!G){G=!0;do{for(let t=0;t<H.length;t+=1){const n=H[t];E(n),D(n.$$)}for(E(null),H.length=0;J.length;)J.pop()();for(let t=0;t<V.length;t+=1){const n=V[t];q.has(n)||(q.add(n),n())}V.length=0}while(H.length);for(;T.length;)T.pop()();I=!1,G=!1,q.clear()}}function D(t){if(null!==t.fragment){t.update(),l(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(R)}}let L;function F(){return L||(L=Promise.resolve(),L.then((()=>{L=null}))),L}function K(t,n,e){t.dispatchEvent(C(`${n?"intro":"outro"}${e}`))}const Q=new Set;let U;function X(){U={r:0,c:[],p:U}}function Y(){U.r||l(U.c),U=U.p}function Z(t,n){t&&t.i&&(Q.delete(t),t.i(n))}function tt(t,n,e,r){if(t&&t.o){if(Q.has(t))return;Q.add(t),U.c.push((()=>{Q.delete(t),r&&(e&&t.d(1),r())})),t.o(n)}}const nt={duration:0};function et(e,r,i,a){let s=r(e,i),u=a?0:1,d=null,h=null,f=null;function _(){f&&W(e,f)}function y(t,n){const e=t.b-u;return n*=Math.abs(e),{a:u,b:t.b,d:e,duration:n,start:t.start,end:t.start+n,group:t.group}}function g(r){const{delay:i=0,duration:o=300,easing:a=n,tick:g=t,css:w}=s||nt,m={start:c()+i,b:r};r||(m.group=U,U.r+=1),d||h?h=m:(w&&(_(),f=S(e,u,r,o,i,a,w)),r&&g(0,1),d=y(m,o),R((()=>K(e,r,"start"))),p((t=>{if(h&&t>h.start&&(d=y(h,o),h=null,K(e,d.b,"start"),w&&(_(),f=S(e,u,d.b,d.duration,0,a,s.css))),d)if(t>=d.end)g(u=d.b,1-u),K(e,d.b,"end"),h||(d.b?_():--d.group.r||l(d.group.c)),d=null;else if(t>=d.start){const n=t-d.start;u=d.a+d.d*a(n/d.duration),g(u,1-u)}return!(!d&&!h)})))}return{run(t){o(s)?F().then((()=>{s=s(),g(t)})):g(t)},end(){_(),d=h=null}}}function rt(t){t&&t.c()}function it(t,n,e,i){const{fragment:a,on_mount:s,on_destroy:c,after_update:u}=t.$$;a&&a.m(n,e),i||R((()=>{const n=s.map(r).filter(o);c?c.push(...n):l(n),t.$$.on_mount=[]})),u.forEach(R)}function lt(t,n){const e=t.$$;null!==e.fragment&&(l(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function ot(t,n){-1===t.$$.dirty[0]&&(H.push(t),I||(I=!0,j.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function at(n,e,r,o,a,s,c,u=[-1]){const d=A;E(n);const h=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:e.target||d.$$.root};c&&c(h.root);let p=!1;if(h.ctx=r?r(n,e.props||{},((t,e,...r)=>{const i=r.length?r[0]:e;return h.ctx&&a(h.ctx[t],h.ctx[t]=i)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](i),p&&ot(n,t)),e})):[],h.update(),p=!0,l(h.before_update),h.fragment=!!o&&o(h.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);h.fragment&&h.fragment.l(t),t.forEach(w)}else h.fragment&&h.fragment.c();e.intro&&Z(n.$$.fragment),it(n,e.target,e.anchor,e.customElement),B()}E(d)}class st{$destroy(){lt(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function ct(t){const n=t-1;return n*n*n+1}function ut(t){return--t*t*t*t*t+1}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function dt(t,{delay:n=0,duration:e=400,easing:r=ct,start:i=0,opacity:l=0}={}){const o=getComputedStyle(t),a=+o.opacity,s="none"===o.transform?"":o.transform,c=1-i,u=a*(1-l);return{delay:n,duration:e,easing:r,css:(t,n)=>`\n\t\t\ttransform: ${s} scale(${1-c*n});\n\t\t\topacity: ${a-u*n}\n\t\t`}}function ht(t){var{fallback:n}=t,r=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}(t,["fallback"]);const i=new Map,l=new Map;function a(t,i,l){return(a,s)=>(t.set(s.key,{rect:a.getBoundingClientRect()}),()=>{if(i.has(s.key)){const{rect:t}=i.get(s.key);return i.delete(s.key),function(t,n,i){const{delay:l=0,duration:a=(t=>30*Math.sqrt(t)),easing:s=ct}=e(e({},r),i),c=n.getBoundingClientRect(),u=t.left-c.left,d=t.top-c.top,h=t.width/c.width,p=t.height/c.height,f=Math.sqrt(u*u+d*d),_=getComputedStyle(n),y="none"===_.transform?"":_.transform,g=+_.opacity;return{delay:l,duration:o(a)?a(f):a,easing:s,css:(t,n)=>`\n\t\t\t\topacity: ${t*g};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${y} translate(${n*u}px,${n*d}px) scale(${t+(1-t)*h}, ${t+(1-t)*p});\n\t\t\t`}}(t,a,s)}return t.delete(s.key),n&&n(a,s,l)})}return[a(l,i,!1),a(i,l,!0)]}const pt={kind:"none",player_id:-1,notable:!1},ft={kind:"ghost",player_id:-1,notable:!1};function _t(t,n){return{kind:"piece",player_id:t,notable:n}}const yt={kind:"unknown"},gt={kind:"pawn"},wt={kind:"vwall"},mt={kind:"hwall"};class $t{constructor(t){this.grid_size=t,this.cell_size=2*t+1}isMargin(t){return 0===t||t===this.cell_size-1}isPath(t){return t%2==0&&!this.isMargin(t)}toGridIndex(t,n){let e=yt;this.isPCell(t,n)?e=gt:this.isVCell(t,n)?e=wt:this.isHCell(t,n)&&(e=mt);return[e,[Math.floor((t-1)/2),Math.floor((n-1)/2)]]}hasPCell(t){return!this.isMargin(t)&&!this.isPath(t)}isPCell(t,n){return this.hasPCell(n)&&this.hasPCell(t)}getPawn(t,n,e){const[r,[i,l]]=this.toGridIndex(n,e);return"pawn"!==r.kind?pt:t[i][l]}isVCell(t,n){return this.hasPCell(t)&&this.isPath(n)}getVerticalWall(t,n,e){const[r,[i,l]]=this.toGridIndex(n,e);return"vwall"!==r.kind||i===this.grid_size-1?pt:t[i][l]}isHCell(t,n){return this.isPath(t)&&this.hasPCell(n)}getHorizontalWall(t,n,e){const[r,[i,l]]=this.toGridIndex(n,e);return"hwall"!==r.kind||l===this.grid_size-1?pt:t[i][l]}}function bt(t,n,e){const r=t.slice();return r[14]=n[e],r}function vt(t,n,e){const r=t.slice();return r[17]=n[e],r[19]=e,r}function kt(t){let n,e,r,i,l,o;const a=[Ct,Pt],s=[];function c(t,r){return(null==n||4&r)&&(n=!("piece"!==t[5].getHorizontalWall(t[2],t[14],t[19]).kind)),n?0:((null==e||4&r)&&(e=!("ghost"!==t[5].getHorizontalWall(t[2],t[14],t[19]).kind)),e?1:-1)}return~(r=c(t,-1))&&(i=s[r]=a[r](t)),{c(){i&&i.c(),l=v()},m(t,n){~r&&s[r].m(t,n),g(t,l,n),o=!0},p(t,n){let e=r;r=c(t,n),r===e?~r&&s[r].p(t,n):(i&&(X(),tt(s[e],1,1,(()=>{s[e]=null})),Y()),~r?(i=s[r],i?i.p(t,n):(i=s[r]=a[r](t),i.c()),Z(i,1),i.m(l.parentNode,l)):i=null)},i(t){o||(Z(i),o=!0)},o(t){tt(i),o=!1},d(t){~r&&s[r].d(t),t&&w(l)}}}function zt(t){let n,e,r,i,l,o;const a=[At,Ot],s=[];function c(t,r){return(null==n||8&r)&&(n=!("piece"!==t[5].getVerticalWall(t[3],t[14],t[19]).kind)),n?0:((null==e||8&r)&&(e=!("ghost"!==t[5].getVerticalWall(t[3],t[14],t[19]).kind)),e?1:-1)}return~(r=c(t,-1))&&(i=s[r]=a[r](t)),{c(){i&&i.c(),l=v()},m(t,n){~r&&s[r].m(t,n),g(t,l,n),o=!0},p(t,n){let e=r;r=c(t,n),r===e?~r&&s[r].p(t,n):(i&&(X(),tt(s[e],1,1,(()=>{s[e]=null})),Y()),~r?(i=s[r],i?i.p(t,n):(i=s[r]=a[r](t),i.c()),Z(i,1),i.m(l.parentNode,l)):i=null)},i(t){o||(Z(i),o=!0)},o(t){tt(i),o=!1},d(t){~r&&s[r].d(t),t&&w(l)}}}function xt(t){let n,e,r,i,l,o;const a=[St,Mt],s=[];function c(t,r){return(null==n||16&r)&&(n=!("piece"!==t[5].getPawn(t[4],t[14],t[19]).kind)),n?0:((null==e||16&r)&&(e=!("ghost"!==t[5].getPawn(t[4],t[14],t[19]).kind)),e?1:-1)}return~(r=c(t,-1))&&(i=s[r]=a[r](t)),{c(){i&&i.c(),l=v()},m(t,n){~r&&s[r].m(t,n),g(t,l,n),o=!0},p(t,n){let e=r;r=c(t,n),r===e?~r&&s[r].p(t,n):(i&&(X(),tt(s[e],1,1,(()=>{s[e]=null})),Y()),~r?(i=s[r],i?i.p(t,n):(i=s[r]=a[r](t),i.c()),Z(i,1),i.m(l.parentNode,l)):i=null)},i(t){o||(Z(i),o=!0)},o(t){tt(i),o=!1},d(t){~r&&s[r].d(t),t&&w(l)}}}function Pt(n){let e;return{c(){e=$("div"),z(e,"class","ghost horizontalWall svelte-pic2r5"),P(e,"player0",0===n[0]||n[1]),P(e,"player1",1===n[0]&&!n[1])},m(t,n){g(t,e,n)},p(t,n){3&n&&P(e,"player0",0===t[0]||t[1]),3&n&&P(e,"player1",1===t[0]&&!t[1])},i:t,o:t,d(t){t&&w(e)}}}function Ct(t){let n,e,r;return{c(){n=$("div"),z(n,"class","horizontalWall svelte-pic2r5"),P(n,"player0",0===t[5].getHorizontalWall(t[2],t[14],t[19]).player_id||t[1]),P(n,"player1",1===t[5].getHorizontalWall(t[2],t[14],t[19]).player_id&&!t[1])},m(t,e){g(t,n,e),r=!0},p(t,e){38&e&&P(n,"player0",0===t[5].getHorizontalWall(t[2],t[14],t[19]).player_id||t[1]),38&e&&P(n,"player1",1===t[5].getHorizontalWall(t[2],t[14],t[19]).player_id&&!t[1])},i(t){r||(R((()=>{e||(e=et(n,dt,{},!0)),e.run(1)})),r=!0)},o(t){e||(e=et(n,dt,{},!1)),e.run(0),r=!1},d(t){t&&w(n),t&&e&&e.end()}}}function Ot(n){let e,r;return{c(){e=$("div"),z(e,"class",r="ghost verticalWall player"+n[0]+" svelte-pic2r5"),P(e,"player0",0===n[0]||n[1]),P(e,"player1",1===n[0]&&!n[1])},m(t,n){g(t,e,n)},p(t,n){1&n&&r!==(r="ghost verticalWall player"+t[0]+" svelte-pic2r5")&&z(e,"class",r),3&n&&P(e,"player0",0===t[0]||t[1]),3&n&&P(e,"player1",1===t[0]&&!t[1])},i:t,o:t,d(t){t&&w(e)}}}function At(t){let n,e,r;return{c(){n=$("div"),z(n,"class","verticalWall svelte-pic2r5"),P(n,"player0",0===t[5].getVerticalWall(t[3],t[14],t[19]).player_id||t[1]),P(n,"player1",1===t[5].getVerticalWall(t[3],t[14],t[19]).player_id&&!t[1])},m(t,e){g(t,n,e),r=!0},p(t,e){42&e&&P(n,"player0",0===t[5].getVerticalWall(t[3],t[14],t[19]).player_id||t[1]),42&e&&P(n,"player1",1===t[5].getVerticalWall(t[3],t[14],t[19]).player_id&&!t[1])},i(t){r||(R((()=>{e||(e=et(n,dt,{},!0)),e.run(1)})),r=!0)},o(t){e||(e=et(n,dt,{},!1)),e.run(0),r=!1},d(t){t&&w(n),t&&e&&e.end()}}}function Mt(n){let e,r;return{c(){e=$("div"),z(e,"class",r="ghost pawn player"+n[0]+" svelte-pic2r5")},m(t,n){g(t,e,n)},p(t,n){1&n&&r!==(r="ghost pawn player"+t[0]+" svelte-pic2r5")&&z(e,"class",r)},i:t,o:t,d(t){t&&w(e)}}}function St(e){let r,i,a,s,u;return{c(){r=$("div"),z(r,"class",i="pawn player"+e[5].getPawn(e[4],e[14],e[19]).player_id+" svelte-pic2r5")},m(t,n){g(t,r,n),u=!0},p(t,n){e=t,(!u||16&n&&i!==(i="pawn player"+e[5].getPawn(e[4],e[14],e[19]).player_id+" svelte-pic2r5"))&&z(r,"class",i)},i(i){u||(R((()=>{s&&s.end(1),a=function(e,r,i){let l,a,s=r(e,i),u=!1,d=0;function h(){l&&W(e,l)}function f(){const{delay:r=0,duration:i=300,easing:o=n,tick:f=t,css:_}=s||nt;_&&(l=S(e,0,1,i,r,o,_,d++)),f(0,1);const y=c()+r,g=y+i;a&&a.abort(),u=!0,R((()=>K(e,!0,"start"))),a=p((t=>{if(u){if(t>=g)return f(1,0),K(e,!0,"end"),h(),u=!1;if(t>=y){const n=o((t-y)/i);f(n,1-n)}}return u}))}let _=!1;return{start(){_||(_=!0,W(e),o(s)?(s=s(),F().then(f)):f())},invalidate(){_=!1},end(){u&&(h(),u=!1)}}}(r,e[9],{key:e[5].getPawn(e[4],e[14],e[19]).player_id}),a.start()})),u=!0)},o(i){a&&a.invalidate(),s=function(e,r,i){let a,s=r(e,i),u=!0;const d=U;function h(){const{delay:r=0,duration:i=300,easing:o=n,tick:h=t,css:f}=s||nt;f&&(a=S(e,1,0,i,r,o,f));const _=c()+r,y=_+i;R((()=>K(e,!1,"start"))),p((t=>{if(u){if(t>=y)return h(0,1),K(e,!1,"end"),--d.r||l(d.c),!1;if(t>=_){const n=o((t-_)/i);h(1-n,n)}}return u}))}return d.r+=1,o(s)?F().then((()=>{s=s(),h()})):h(),{end(t){t&&s.tick&&s.tick(1,0),u&&(a&&W(e,a),u=!1)}}}(r,e[8],{key:e[5].getPawn(e[4],e[14],e[19]).player_id}),u=!1},d(t){t&&w(r),t&&s&&s.end()}}}function Wt(t){let n,e,r,i,o=!t[5].isMargin(t[14])&&!t[5].isMargin(t[19]),a=o&&function(t){let n,e,r,i;const l=[xt,zt,kt],o=[];return~(e=function(t,n){return t[5].isPCell(t[14],t[19])?0:t[5].isVCell(t[14],t[19])?1:t[5].isHCell(t[14],t[19])?2:-1}(t))&&(r=o[e]=l[e](t)),{c(){n=$("div"),r&&r.c(),z(n,"class","cell svelte-pic2r5")},m(t,r){g(t,n,r),~e&&o[e].m(n,null),i=!0},p(t,n){r&&r.p(t,n)},i(t){i||(Z(r),i=!0)},o(t){tt(r),i=!1},d(t){t&&w(n),~e&&o[e].d()}}}(t);return{c(){n=$("div"),a&&a.c(),z(n,"class","svelte-pic2r5"),P(n,"columnPCell",t[5].hasPCell(t[19])),P(n,"columnPath",t[5].isPath(t[19])),P(n,"columnMargin",t[5].isMargin(t[19]))},m(l,o){g(l,n,o),a&&a.m(n,null),e=!0,r||(i=[k(n,"mouseenter",t[6](t[14],t[19])),k(n,"click",t[7](t[14],t[19]))],r=!0)},p(n,e){t=n,o&&a.p(t,e)},i(t){e||(Z(a),e=!0)},o(t){tt(a),e=!1},d(t){t&&w(n),a&&a.d(),r=!1,l(i)}}}function Et(t){let n,e,r,i=Array.from({length:t[5].cell_size},Ht),l=[];for(let n=0;n<i.length;n+=1)l[n]=Wt(vt(t,i,n));const o=t=>tt(l[t],1,1,(()=>{l[t]=null}));return{c(){n=$("div");for(let t=0;t<l.length;t+=1)l[t].c();e=b(" "),z(n,"class","columnContainer svelte-pic2r5"),P(n,"rowPCell",t[5].hasPCell(t[14])),P(n,"rowPath",t[5].isPath(t[14])),P(n,"rowMargin",t[5].isMargin(t[14]))},m(t,i){g(t,n,i);for(let t=0;t<l.length;t+=1)l[t].m(n,null);f(n,e),r=!0},p(t,r){if(255&r){let a;for(i=Array.from({length:t[5].cell_size},Ht),a=0;a<i.length;a+=1){const o=vt(t,i,a);l[a]?(l[a].p(o,r),Z(l[a],1)):(l[a]=Wt(o),l[a].c(),Z(l[a],1),l[a].m(n,e))}for(X(),a=i.length;a<l.length;a+=1)o(a);Y()}32&r&&P(n,"rowPCell",t[5].hasPCell(t[14])),32&r&&P(n,"rowPath",t[5].isPath(t[14])),32&r&&P(n,"rowMargin",t[5].isMargin(t[14]))},i(t){if(!r){for(let t=0;t<i.length;t+=1)Z(l[t]);r=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)tt(l[t]);r=!1},d(t){t&&w(n),m(l,t)}}}function Nt(t){let n,e,r=Array.from({length:t[5].cell_size},t[12]),i=[];for(let n=0;n<r.length;n+=1)i[n]=Et(bt(t,r,n));const l=t=>tt(i[t],1,1,(()=>{i[t]=null}));return{c(){n=$("div");for(let t=0;t<i.length;t+=1)i[t].c();z(n,"class","rowContainer svelte-pic2r5")},m(t,r){g(t,n,r);for(let t=0;t<i.length;t+=1)i[t].m(n,null);e=!0},p(t,[e]){if(255&e){let o;for(r=Array.from({length:t[5].cell_size},t[12]),o=0;o<r.length;o+=1){const l=bt(t,r,o);i[o]?(i[o].p(l,e),Z(i[o],1)):(i[o]=Et(l),i[o].c(),Z(i[o],1),i[o].m(n,null))}for(X(),o=r.length;o<i.length;o+=1)l(o);Y()}},i(t){if(!e){for(let t=0;t<r.length;t+=1)Z(i[t]);e=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)tt(i[t]);e=!1},d(t){t&&w(n),m(i,t)}}}const Ht=(t,n)=>n;function Jt(t,n,e){let r,i,l,{grid_size:o=9}=n,{current_player_id:a=0}=n,{option_same_wall_color:s=!1}=n;const c=new $t(o);let{board:u}=n;const d=N();const[h,p]=ht({duration:t=>Math.sqrt(700*t),fallback(t){const n=getComputedStyle(t),e="none"===n.transform?"":n.transform;return{duration:6e3,easing:ut,css:t=>`\n\t\t\t\t\ttransform: ${e} scale(${t});\n\t\t\t\t\topacity: ${t}\n\t\t\t\t`}}});return t.$$set=t=>{"grid_size"in t&&e(10,o=t.grid_size),"current_player_id"in t&&e(0,a=t.current_player_id),"option_same_wall_color"in t&&e(1,s=t.option_same_wall_color),"board"in t&&e(11,u=t.board)},t.$$.update=()=>{2048&t.$$.dirty&&e(4,r=u.pawn),2048&t.$$.dirty&&e(3,i=u.vertical_wall),2048&t.$$.dirty&&e(2,l=u.horizontal_wall)},[a,s,l,i,r,c,function(t,n){return()=>{let e,r;[e,r]=c.toGridIndex(t,n),d("hoverCell",{pieceType:e,nextPosition:r,cx:n,cy:t})}},function(t,n){return()=>{let e,r;[e,r]=c.toGridIndex(t,n),d("clickCell",{pieceType:e,nextPosition:r,cx:n,cy:t})}},h,p,o,u,(t,n)=>c.cell_size-n-1]}class Vt extends st{constructor(t){super(),at(this,t,Jt,Nt,a,{grid_size:10,current_player_id:0,option_same_wall_color:1,board:11})}}function Tt(t){return"piece"===t.kind}function jt(t,n,e){const r=e.pawn.length;if(t>=r-1)return!1;let i=!0;return n>0&&(i=i&&!Tt(e.horizontal_wall[t][n-1])),n<r-1&&(i=i&&!Tt(e.horizontal_wall[t][n])),i}function It(t,n,e){const r=e.pawn.length;if(0===t)return!1;let i=!0;return n>0&&(i=i&&!Tt(e.horizontal_wall[t-1][n-1])),n<r-1&&(i=i&&!Tt(e.horizontal_wall[t-1][n])),i}function Rt(t,n,e){const r=e.pawn.length;if(n===r-1)return!1;let i=!0;return t>0&&(i=i&&!Tt(e.vertical_wall[t-1][n])),t<r-1&&(i=i&&!Tt(e.vertical_wall[t][n])),i}function Gt(t,n,e){const r=e.pawn.length;if(0===n)return!1;let i=!0;return t>0&&(i=i&&!Tt(e.vertical_wall[t-1][n-1])),t<r-1&&(i=i&&!Tt(e.vertical_wall[t][n-1])),i}function qt(t,n,e){if(t[0]===n[0]&&t[1]===n[1]||Tt(e.pawn[n[0]][n[1]]))return!1;let r=t,i=n;const l=i[0]-r[0],o=i[1]-r[1],a=Math.abs(l)+Math.abs(o);if(1===a)return 0===l?(r[1]<=i[1]||([r,i]=[i,r]),Rt(r[0],r[1],e)):(r[0]<=i[0]||([r,i]=[i,r]),jt(r[0],r[1],e));if(2===a){if(o*l==0)return 0===l?(r[1]<=i[1]||([r,i]=[i,r]),Rt(r[0],r[1],e)&&Rt(r[0],r[1]+1,e)&&Tt(e.pawn[r[0]][r[1]+1])):(r[0]<=i[0]||([r,i]=[i,r]),jt(r[0],r[1],e)&&jt(r[0]+1,r[1],e)&&Tt(e.pawn[r[0]+1][r[1]]));{const t=jt(r[0],r[1],e)&&!jt(r[0]+1,r[1],e)&&Tt(e.pawn[r[0]+1][r[1]]),n=It(r[0],r[1],e)&&!It(r[0]-1,r[1],e)&&Tt(e.pawn[r[0]-1][r[1]]),l=Rt(r[0],r[1],e)&&!Rt(r[0],r[1]+1,e)&&Tt(e.pawn[r[0]][r[1]+1]),o=Gt(r[0],r[1],e)&&!Gt(r[0],r[1]-1,e)&&Tt(e.pawn[r[0]][r[1]-1]);return r[1]<i[1]?r[0]<i[0]?t&&Rt(r[0]+1,r[1],e)||l&&jt(r[0],r[1]+1,e):n&&Rt(r[0]-1,r[1],e)||l&&It(r[0],r[1]+1,e):r[0]<i[0]?t&&Gt(r[0]+1,r[1],e)||o&&jt(r[0],r[1]-1,e):n&&Gt(r[0]-1,r[1],e)||o&&It(r[0],r[1]-1,e)}}return!1}function Bt(t,n){const e=n.pawn.length;for(let r=0;r<e;r++)for(let i=0;i<e;i++)"piece"!==n.pawn[r][i].kind&&(n.pawn[r][i]=qt(t,[r,i],n)?ft:pt)}class Dt{constructor(t,n=[],e=0){this.grid_size=t;const r=t,i=[...Array(r)].map((()=>Array(r).fill(ft))),l=Math.floor(r/2);i[0][l]=_t(0,!1),i[r-1][l]=_t(1,!1);const o=[...Array(r-1)].map((()=>Array(r-1).fill(ft))),a=[...Array(r-1)].map((()=>Array(r-1).fill(ft)));this.board={pawn:i,vertical_wall:o,horizontal_wall:a},this.current_pawn=[[0,l],[r-1,l]],this.goal=[[...Array(r)].map(((t,n)=>[r-1,n])),[...Array(r)].map(((t,n)=>[0,n]))],this.current_player=-1,this.nextTurn(),this.history=n,this.history_index=e}nextTurn(){this.current_player=(this.current_player+1)%2,Bt(this.current_pawn[this.current_player],this.board)}loadHistory(t){const n=JSON.parse(JSON.stringify(this.board));t.split(",").forEach((t=>{const e=[parseInt(t[1])-1,t[0].codePointAt(0)-"a".codePointAt(0)];let r,i;if(2===t.length)r=gt,i=this.current_pawn[this.current_player];else if(3===t.length&&"v"===t[2])r=wt,i=[-1,-1];else{if(3!==t.length||"h"!==t[2])return;r=mt,i=[-1,-1]}const l={piece:r,to:e,from:i};"pawn"===r.kind?(n.pawn[i[0]][i[1]]=pt,n.pawn[e[0]][e[1]]=_t(this.current_player,!1),this.current_pawn[this.current_player]=e):"vwall"===r.kind?n.vertical_wall[e[0]][e[1]]=_t(this.current_player,!1):"hwall"===r.kind&&(n.horizontal_wall[e[0]][e[1]]=_t(this.current_player,!1)),this.history.push(l),this.history_index++,this.current_player=(this.current_player+1)%2})),this.board=n,Bt(this.current_pawn[this.current_player],this.board)}handleTurn(t,n){const e=this.current_pawn[this.current_player],[r,i]=n;if("unknown"===t.kind)return!1;if("pawn"===t.kind){if(!qt(e,n,this.board))return!1;const l=JSON.parse(JSON.stringify(this.board.pawn));this.commitHistory(t,n);const[o,a]=e;return l[o][a]=pt,l[r][i]=_t(this.current_player,!1),this.board.pawn=l,this.current_pawn[this.current_player]=[r,i],!0}const l=JSON.parse(JSON.stringify(this.board));if("vwall"===t.kind){if(r===this.grid_size-1)return!1;if("piece"===this.board.vertical_wall[r][i].kind)return!1;l.vertical_wall[r][i]=_t(this.current_player,!1)}else if("hwall"===t.kind){if(i===this.grid_size-1)return!1;if("piece"===this.board.horizontal_wall[r][i].kind)return!1;l.horizontal_wall[r][i]=_t(this.current_player,!1)}return function(t,n,e){const r=e.pawn.length;for(let t=0;t<r-1;t++)for(let n=0;n<r-1;n++){if(Tt(e.vertical_wall[t][n])&&Tt(e.horizontal_wall[t][n]))return!1;if(t!==r-2&&Tt(e.vertical_wall[t][n])&&Tt(e.vertical_wall[t+1][n]))return!1;if(n!==r-2&&Tt(e.horizontal_wall[t][n])&&Tt(e.horizontal_wall[t][n+1]))return!1}let i;function l(t,n){i[t][n]||(i[t][n]=!0,jt(t,n,e)&&l(t+1,n),It(t,n,e)&&l(t-1,n),Rt(t,n,e)&&l(t,n+1),Gt(t,n,e)&&l(t,n-1))}for(let e=0;e<t.length;e++){let o=!1;const a=t[e],s=n[e];i=[...Array(r)].map((()=>Array(r).fill(!1))),l(a[0],a[1]);for(let t=0;t<s.length;t++){const[n,e]=s[t];!0===i[n][e]&&(o=!0)}if(!o)return!1}return!0}(this.current_pawn,this.goal,l)?(this.commitHistory(t,n),this.board=l,!0):void 0}commitHistory(t,n){const e=this.current_pawn[this.current_player],r=this.history.slice(0,this.history_index);this.history_index++,r.push({piece:t,from:e,to:n}),this.history=r}previousStep(){if(this.history_index-1<0)return!1;this.history_index--;const t=this.history[this.history_index],n=t.piece.kind,[e,r]=t.from,[i,l]=t.to;if("pawn"===n){const t=(this.current_player+1)%2,n=JSON.parse(JSON.stringify(this.board.pawn));n[i][l]=pt,n[e][r]=_t(t,!1),this.board.pawn=n,this.current_pawn[t]=[e,r]}else"vwall"===n?this.board.vertical_wall[i][l]=pt:"hwall"===n&&(this.board.horizontal_wall[i][l]=pt);return!0}nextStep(){if(this.history_index+1>this.history.length)return!1;const t=this.history[this.history_index],n=t.piece.kind,[e,r]=t.from,[i,l]=t.to;if("pawn"===n){const t=JSON.parse(JSON.stringify(this.board.pawn));t[e][r]=pt,t[i][l]=_t(this.current_player,!1),this.board.pawn=t,this.current_pawn[this.current_player]=[i,l]}else"vwall"===n?this.board.vertical_wall[i][l]=_t(this.current_player,!1):"hwall"===n&&(this.board.horizontal_wall[i][l]=_t(this.current_player,!1));return this.history_index++,!0}dumpHistory(){const t=[];for(let n=0;n<this.history.length;n++){const e=this.history[n];let r="";r+=String.fromCharCode("a".charCodeAt(0)+e.to[1]),r+=e.to[0]+1,"vwall"===e.piece.kind?r+="v":"hwall"===e.piece.kind&&(r+="h"),t.push(r)}return t}}function Lt(t){let n,e,r;return e=new Vt({props:{grid_size:t[0],current_player_id:t[3],board:t[2]}}),e.$on("clickCell",t[4]),{c(){n=$("div"),rt(e.$$.fragment),x(n,"--board-area",t[1]),z(n,"class","svelte-wg0nh")},m(t,i){g(t,n,i),it(e,n,null),r=!0},p(t,[i]){const l={};1&i&&(l.grid_size=t[0]),8&i&&(l.current_player_id=t[3]),4&i&&(l.board=t[2]),e.$set(l),(!r||2&i)&&x(n,"--board-area",t[1])},i(t){r||(Z(e.$$.fragment,t),r=!0)},o(t){tt(e.$$.fragment,t),r=!1},d(t){t&&w(n),lt(e)}}}function Ft(t,n,e){let r,i,{board_size:l="500px"}=n,{grid_size:o=9}=n,a=new Dt(o);return t.$$set=t=>{"board_size"in t&&e(1,l=t.board_size),"grid_size"in t&&e(0,o=t.grid_size)},t.$$.update=()=>{32&t.$$.dirty&&e(0,o=a.grid_size),32&t.$$.dirty&&e(3,r=a.current_player),32&t.$$.dirty&&e(2,i=a.board)},[o,l,i,r,function(t){const n=t.detail.pieceType,r=t.detail.nextPosition;a.handleTurn(n,r)&&(a.nextTurn(),e(5,a))},a]}class Kt extends st{constructor(t){super(),at(this,t,Ft,Lt,a,{board_size:1,grid_size:0})}}function Qt(n){let e,r;return e=new Kt({props:{grid_size:9,board_size:"60vmin"}}),{c(){rt(e.$$.fragment)},m(t,n){it(e,t,n),r=!0},p:t,i(t){r||(Z(e.$$.fragment,t),r=!0)},o(t){tt(e.$$.fragment,t),r=!1},d(t){lt(e,t)}}}return new class extends st{constructor(t){super(),at(this,t,null,Qt,a,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
